<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard da Turma</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/3da44e21a2.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../assets/css/dashboard.css">
</head>
<body>
  <div class="app-container">
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="app-icon">
          </div>
      </div>
      <ul class="sidebar-list">
        <li class="sidebar-list-item" data-target="provas">
          <a href="#">
            <i class="fas fa-file-alt me-2"></i>
            <span>Provas</span>
          </a>
        </li>
        <li class="sidebar-list-item" data-target="redacoes">
          <a href="#">
            <i class="fas fa-pencil-alt me-2"></i>
            <span>Redações</span>
          </a>
        </li>
      </ul>
      <div class="account-info">
        </div>
    </div>
    <div class="app-content">
      <div class="app-content-header">
        <h1 class="app-content-headerText" id="turmaNome">Turma: </h1>
      </div>
      <div class="products-area-wrapper tableView" id="conteudoTurma">
        <!-- Conteúdo da turma será carregado aqui -->
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script type="module">
        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAbzHqrxU1bfZlCe8LWtizy12-40zdUfDE",
            authDomain: "teste-97fc6.firebaseapp.com",
            projectId: "teste-97fc6",
            storageBucket: "teste-97fc6.appspot.com",
            messagingSenderId: "470428227917",
            appId: "1:470428227917:web:ef9308034050ca366a3f04",
            measurementId: "G-F50QJE3734"
        };

        // Inicializa o Firebase
        const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    // const turmaNome = document.getElementById('turmaNome');
    const conteudoTurma = document.getElementById('conteudoTurma');

    const urlParams = new URLSearchParams(window.location.search);
    const turmaNome = decodeURIComponent(urlParams.get('turma')); 

    let currentUserId = null;
    let turmaId = null; 

    auth.onAuthStateChanged(user => {
      if (user) {
        currentUserId = user.uid;
        const urlParams = new URLSearchParams(window.location.search);
        turmaId = urlParams.get('turmaId');
        carregarTurma(turmaId);
      } else {
        window.location.href = '../pages/login-professor.html'; // Redireciona para a página de login se não estiver autenticado
      }
    });

    async function carregarTurma(turmaId) {
      if (!turmaId) return; // Sai da função se turmaId não estiver definido

      try {
        const turmaDoc = await db.collection('instituicoes').doc(currentUserId).collection('turmas').doc(turmaId).get();
        if (turmaDoc.exists) {
          const turmaData = turmaDoc.data();
          turmaNome.textContent = `Turma: ${turmaData.turma}`;
          carregarProvas();
        } else {
          turmaNome.textContent = 'Turma não encontrada';
        }
      } catch (error) {
        console.error('Erro ao carregar dados da turma:', error);
      }
    }

    const sidebarItems = document.querySelectorAll('.sidebar-list-item');

    sidebarItems.forEach(item => {
      item.addEventListener('click', () => {
        const target = item.dataset.target;

        sidebarItems.forEach(i => i.classList.remove('active'));
        item.classList.add('active');

        if (target === 'provas') {
          carregarProvas();
        } else if (target === 'redacoes') {
          carregarRedacoes();
        }
      });
    });

    function carregarProvas() {
      conteudoTurma.innerHTML = '<h2>Provas</h2>'; 
      // Adicione lógica para carregar e exibir provas
    }

    function carregarRedacoes() {
      conteudoTurma.innerHTML = '<h2>Redações</h2>'; 
      // Adicione lógica para carregar e exibir redações
    }
  </script>
</body>
</html>